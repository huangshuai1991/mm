{"remainingRequest":"F:\\emanager\\node_modules\\babel-loader\\lib\\index.js!F:\\emanager\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\emanager\\src\\store\\modules\\user.js","dependencies":[{"path":"F:\\emanager\\src\\store\\modules\\user.js","mtime":1604888126751},{"path":"F:\\emanager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\emanager\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\emanager\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L2VtYW5hZ2VyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IHsgdXNlckxvZ2luLCBnZXRVc2VySW5mbywgdXNlckxvZ291dCB9IGZyb20gJy4uLy4uL2FwaS91c2VyL3VzZXInOwppbXBvcnQgeyBzZXRUb2tlbiwgZ2V0VG9rZW4sIHJlbW92ZVRva2VuIH0gZnJvbSAnLi4vLi4vdXRpbHMvYXV0aCc7CnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIHJvbGVzOiBbXQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICAgIH0sCiAgICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIG5hbWUpIHsKICAgICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgICB9LAogICAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICAgIH0sCiAgICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgICAgc3RhdGUucm9sZXMgPSByb2xlczsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIC8vIOeZu+W9lQogICAgTG9naW46IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9Mb2dpbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmLCB1c2VySW5mbykgewogICAgICAgIHZhciBjb21taXQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgICB1c2VySW5mby51c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLnRyaW0oKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgICAgdXNlckxvZ2luKHVzZXJJbmZvKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2U7CiAgICAgICAgICAgICAgICAgICAgc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgICAgICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBMb2dpbihfeCwgX3gyKSB7CiAgICAgICAgcmV0dXJuIF9Mb2dpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gTG9naW47CiAgICB9KCksCiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIEdldFVzZXJJbmZvOiBmdW5jdGlvbiBHZXRVc2VySW5mbyhfcmVmMikgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBnZXRVc2VySW5mbyhzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICBpZiAoZGF0YS5yb2xlcyAmJiBkYXRhLnJvbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBkYXRhLnJvbGVzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdCgnZ2V0SW5mbzogcm9sZXMgbXVzdCBiZSBhIG5vbi1udWxsIGFycmF5ICEnKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgZGF0YS5uYW1lKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGRhdGEuYXZhdGFyKTsKICAgICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvlh7oKICAgIExvZ091dDogZnVuY3Rpb24gTG9nT3V0KF9yZWYzKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHVzZXJMb2dvdXQoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIFtdKTsKICAgICAgICAgIHJlbW92ZVRva2VuKCk7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDliY3nq68g55m75Ye6CiAgICBGZWRMb2dPdXQ6IGZ1bmN0aW9uIEZlZExvZ091dChfcmVmNCkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsKICAgICAgcmVtb3ZlVG9rZW4oKTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IHVzZXI7"},{"version":3,"sources":["F:/emanager/src/store/modules/user.js"],"names":["userLogin","getUserInfo","userLogout","setToken","getToken","removeToken","user","state","token","name","avatar","roles","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","actions","Login","userInfo","commit","username","trim","Promise","resolve","reject","then","response","data","error","GetUserInfo","length","LogOut","FedLogOut"],"mappings":";;;;;AAAA,SAASA,SAAT,EAAoBC,WAApB,EAAiCC,UAAjC,QAAmD,qBAAnD;AACA,SAASC,QAAT,EAAmBC,QAAnB,EAA6BC,WAA7B,QAAgD,kBAAhD;AAEA,IAAMC,IAAI,GAAG;AACXC,EAAAA,KAAK,EAAE;AACLC,IAAAA,KAAK,EAAEJ,QAAQ,EADV;AAELK,IAAAA,IAAI,EAAE,EAFD;AAGLC,IAAAA,MAAM,EAAE,EAHH;AAILC,IAAAA,KAAK,EAAE;AAJF,GADI;AAOXC,EAAAA,SAAS,EAAE;AACTC,IAAAA,SAAS,EAAE,mBAACN,KAAD,EAAQC,KAAR,EAAkB;AAC3BD,MAAAA,KAAK,CAACC,KAAN,GAAcA,KAAd;AACD,KAHQ;AAITM,IAAAA,QAAQ,EAAE,kBAACP,KAAD,EAAQE,IAAR,EAAiB;AACzBF,MAAAA,KAAK,CAACE,IAAN,GAAaA,IAAb;AACD,KANQ;AAOTM,IAAAA,UAAU,EAAE,oBAACR,KAAD,EAAQG,MAAR,EAAmB;AAC7BH,MAAAA,KAAK,CAACG,MAAN,GAAeA,MAAf;AACD,KATQ;AAUTM,IAAAA,SAAS,EAAE,mBAACT,KAAD,EAAQI,KAAR,EAAkB;AAC3BJ,MAAAA,KAAK,CAACI,KAAN,GAAcA,KAAd;AACD;AAZQ,GAPA;AAqBXM,EAAAA,OAAO,EAAE;AACP;AACAC,IAAAA,KAAK;AAAA,2EAAE,uBAAmBC,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,gBAAAA,MAAT,QAASA,MAAT;AACLD,gBAAAA,QAAQ,CAACE,QAAT,GAAoBF,QAAQ,CAACE,QAAT,CAAkBC,IAAlB,EAApB;AADK,iDAEE,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCzB,kBAAAA,SAAS,CAACmB,QAAD,CAAT,CAAoBO,IAApB,CAAyB,UAAAC,QAAQ,EAAI;AACnC,wBAAMC,IAAI,GAAGD,QAAb;AACAxB,oBAAAA,QAAQ,CAACyB,IAAI,CAACpB,KAAN,CAAR;AACAY,oBAAAA,MAAM,CAAC,WAAD,EAAcQ,IAAI,CAACpB,KAAnB,CAAN;AACAgB,oBAAAA,OAAO,CAACG,QAAD,CAAP;AACD,mBALD,WAKS,UAAAE,KAAK,EAAI;AAChBJ,oBAAAA,MAAM,CAACI,KAAD,CAAN;AACD,mBAPD;AAQD,iBATM,CAFF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OAFE;AAgBP;AACAC,IAAAA,WAjBO,8BAiByB;AAAA,UAAjBV,MAAiB,SAAjBA,MAAiB;AAAA,UAATb,KAAS,SAATA,KAAS;AAC9B,aAAO,IAAIgB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCxB,QAAAA,WAAW,CAACM,KAAK,CAACC,KAAP,CAAX,CAAyBkB,IAAzB,CAA8B,UAAAC,QAAQ,EAAI;AACxC,cAAMC,IAAI,GAAGD,QAAQ,CAACC,IAAtB;;AACA,cAAIA,IAAI,CAACjB,KAAL,IAAciB,IAAI,CAACjB,KAAL,CAAWoB,MAAX,GAAoB,CAAtC,EAAyC;AACvCX,YAAAA,MAAM,CAAC,WAAD,EAAcQ,IAAI,CAACjB,KAAnB,CAAN;AACD,WAFD,MAEO;AACLc,YAAAA,MAAM,CAAC,2CAAD,CAAN;AACD;;AACDL,UAAAA,MAAM,CAAC,UAAD,EAAaQ,IAAI,CAACnB,IAAlB,CAAN;AACAW,UAAAA,MAAM,CAAC,YAAD,EAAeQ,IAAI,CAAClB,MAApB,CAAN;AACAc,UAAAA,OAAO,CAACI,IAAD,CAAP;AACD,SAVD,WAUS,UAAAC,KAAK,EAAI;AAChBJ,UAAAA,MAAM,CAACI,KAAD,CAAN;AACD,SAZD;AAaD,OAdM,CAAP;AAeD,KAjCM;AAmCP;AACAG,IAAAA,MApCO,yBAoCoB;AAAA,UAAjBZ,MAAiB,SAAjBA,MAAiB;AAAA,UAATb,KAAS,SAATA,KAAS;AACzB,aAAO,IAAIgB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCvB,QAAAA,UAAU,CAACK,KAAK,CAACC,KAAP,CAAV,CAAwBkB,IAAxB,CAA6B,YAAM;AACjCN,UAAAA,MAAM,CAAC,WAAD,EAAc,EAAd,CAAN;AACAA,UAAAA,MAAM,CAAC,WAAD,EAAc,EAAd,CAAN;AACAf,UAAAA,WAAW;AACXmB,UAAAA,OAAO;AACR,SALD,WAKS,UAAAK,KAAK,EAAI;AAChBJ,UAAAA,MAAM,CAACI,KAAD,CAAN;AACD,SAPD;AAQD,OATM,CAAP;AAUD,KA/CM;AAgDP;AACAI,IAAAA,SAAS,EAAE,0BAAgB;AAAA,UAAbb,MAAa,SAAbA,MAAa;AACzBA,MAAAA,MAAM,CAAC,WAAD,EAAc,EAAd,CAAN;AACAf,MAAAA,WAAW;AACZ;AApDM;AArBE,CAAb;AA6EA,eAAeC,IAAf","sourcesContent":["import { userLogin, getUserInfo, userLogout } from '../../api/user/user'\r\nimport { setToken, getToken, removeToken } from '../../utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: [],\r\n  },\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    }\r\n  },\r\n  actions: {\r\n    // 登录\r\n    Login: async ({ commit }, userInfo) => {\r\n      userInfo.username = userInfo.username.trim()\r\n      return new Promise((resolve, reject) => {\r\n        userLogin(userInfo).then(response => {\r\n          const data = response\r\n          setToken(data.token)\r\n          commit('SET_TOKEN', data.token)\r\n          resolve(response)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetUserInfo ({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getUserInfo(state.token).then(response => {\r\n          const data = response.data;\r\n          if (data.roles && data.roles.length > 0) {\r\n            commit('SET_ROLES', data.roles)\r\n          } else {\r\n            reject('getInfo: roles must be a non-null array !')\r\n          }\r\n          commit('SET_NAME', data.name)\r\n          commit('SET_AVATAR', data.avatar)\r\n          resolve(data)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 登出\r\n    LogOut ({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        userLogout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n    // 前端 登出\r\n    FedLogOut: ({ commit }) => {\r\n      commit('SET_TOKEN', '')\r\n      removeToken()\r\n    }\r\n  },\r\n}\r\n\r\nexport default user;"]}]}